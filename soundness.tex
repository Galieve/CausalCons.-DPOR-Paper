\subsection{Soundness}

\begin{lemma}
\label{lemma:soundness-swap}
For any reachable history $h$, if $h' = \swap(h_p, r, t)$ for some $r, t \in h$, then $\swapped{h'}{r}$ holds.
\end{lemma}
\begin{proof}
To prove this lemma we are simply checking every condition stated in the function. As in $h'$ $(r, t) \in \wro$, $t < r$. \textcolor{red}{Incomplete, seems I have to prove this at the same time as $\ora$-respectfulness... (lemma \ref{lemma:reachable-or-respectful} )}
Finally, as every $\iread$ event $e \in h' \setminus \{r\}$ reads from the same transaction in both $h$ and $h'$, we conclude $\swapped{h'}{r}$ holds.
\end{proof}

\begin{theorem}
Algorithm \ref{algorithm:optimal-instantiated} is sound.
\begin{proof}
We want to prove that any computable path is formed by $\mathcal{I}$-sound histories. For doing so, we will do an induction on the number of steps this path has. The base case, when the path is empty, is due to the initial state. There, the history has to be $\emptyset$, which is $\mathcal{I}$-consistent. Thus, let's prove the inductive step, assuming that in any computable path of length at most $n$ every history is consistent. Let be $p$ a computable path of length $n+1$ and $h$ its last history. 

As $p \setminus \{h\}$ is a computable path of length $n$, every history is consistent; so in particular the immediate predecessor of $h$ in $p$: $h_p$. Let $a = \nextEvent(h_p)$, which is always a $\so \cup \wro$-maximal event. If $a$ is not a $\iread$ event and $h = h_p \oplus e$, by definition \ref{def:causally-extensible} we know $h$ is consistent. Analogously, if $a$ is a $\iread$ event and $h = h_p \oplus \wro(r, t)$ for some $t \in h_p$, by $\validWrites$'s definition we know $h$ is consistent. Finally, if $h = \swap(h_p, r, t)$ for some event $r$ and transaction $t$, as $\protocol(h_p, r, t)$ is satisfied, $h$ is consistent.
\end{proof}
\end{theorem}